<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>MINA - MANUTENÇÃO</title>
<link rel="stylesheet" href="stile.css" />
</head>
<body>

<h2>STATUS - MINA MANUTENÇÃO</h2>
<form id="equipamentoForm">
  <label for="nomeEquip">PAINEL DE OPERAÇÃO:</label>
  <input type="text" id="nomeEquip" required />
  
  <label for="statusEquip">Status:</label>
  <select id="statusEquip" required>
    <option value="" disabled selected>Selecione o status</option>
    <option value="parado">Parado</option>
    <option value="liberado">Liberado</option>
    <option value="standby">Standby</option>
  </select>
  
  <label for="causaParada">EQUIPAMENTO /CAUSA:</label>
  <input type="text" id="causaParada" placeholder="Equipamento e a causa (se aplicável)" />
  
  <label for="horaInicio">Horário Início:</label>
  <input type="time" id="horaInicio" />
  
  <label for="horaFim">Horário Fim:</label>
  <input type="time" id="horaFim" />
  
  <button type="submit">Cadastrar</button>
  <button type="submit" id="limparBtn">Limpar</button>
  
</form>
<div style="text-align-last: left; margin-bottom: 20px;">
  <img src="Stratos.jpg" alt="Logomarca" style="max-width: 200px; height: auto;" />
  </div>
<h2>STATUS MINA</h2>

<table id="relatorioEquip">
  <thead>
    <tr>
      <th>Equipamento</th>
      <th>Status</th>
      <th>Causa da Parada</th>
      <th>Horário Início</th>
      <th>Horário Fim</th>
      <th>Data e Hora Cadastro</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    <!-- Equipamentos cadastrados aparecem aqui -->
  </tbody>
</table>

<script>
  const form = document.getElementById('equipamentoForm');
  const nomeInput = document.getElementById('nomeEquip');
  const statusSelect = document.getElementById('statusEquip');
  const causaInput = document.getElementById('causaParada');
  const horaInicioInput = document.getElementById('horaInicio');
  const horaFimInput = document.getElementById('horaFim');
  const tabelaCorpo = document.querySelector('#relatorioEquip tbody');
  const limparBtn = document.getElementById('limparBtn');

limparBtn.addEventListener('click', () => {
  form.reset();
  editandoIndex = null;
  nomeInput.focus();
});

  let equipamentos = [];
  let editandoIndex = null;

  function formatDateTime(date) {
    const options = { 
      year: 'numeric', month: '2-digit', day: '2-digit', 
      hour: '2-digit', minute: '2-digit', second: '2-digit' 
    };
    return new Intl.DateTimeFormat('pt-BR', options).format(date);
  }

  function renderTabela() {
    tabelaCorpo.innerHTML = '';
    equipamentos.forEach((equip, idx) => {
      const tr = document.createElement('tr');

      const tdNome = document.createElement('td');
      tdNome.textContent = equip.nome;

      const tdStatus = document.createElement('td');
      tdStatus.textContent = equip.status.charAt(0).toUpperCase() + equip.status.slice(1);
      tdStatus.className = `status-${equip.status}`;

      const tdCausa = document.createElement('td');
      tdCausa.textContent = equip.causa || '-';

      const tdHoraInicio = document.createElement('td');
      tdHoraInicio.textContent = equip.horaInicio || '-';

      const tdHoraFim = document.createElement('td');
      tdHoraFim.textContent = equip.horaFim || '-';

      const tdDataHora = document.createElement('td');
      tdDataHora.textContent = equip.dataHoraCadastro || '-';

      const tdAcoes = document.createElement('td');
      tdAcoes.innerHTML = `
        <button class="btn editar" onclick="editarEquipamento(${idx})">Editar</button>
        <button class="btn excluir" onclick="excluirEquipamento(${idx})">Excluir</button>
      `;

      tr.appendChild(tdNome);
      tr.appendChild(tdStatus);
      tr.appendChild(tdCausa);
      tr.appendChild(tdHoraInicio);
      tr.appendChild(tdHoraFim);
      tr.appendChild(tdDataHora);
      tr.appendChild(tdAcoes);

      tabelaCorpo.appendChild(tr);
    });
  }

  form.addEventListener('submit', function(event) {
    event.preventDefault();

    const nome = nomeInput.value.trim();
    const status = statusSelect.value;
    const causa = causaInput.value.trim();
    const horaInicio = horaInicioInput.value;
    const horaFim = horaFimInput.value;

    if (!nome || !status) return;

    const dataHoraCadastro = formatDateTime(new Date());

    const equipamentoObj = {
      nome,
      status,
      causa,
      horaInicio,
      horaFim,
      dataHoraCadastro
    };

    if (editandoIndex !== null) {
      equipamentos[editandoIndex] = equipamentoObj;
      editandoIndex = null;
    } else {
      equipamentos.push(equipamentoObj);
    }

    renderTabela();
    form.reset();
  });

  window.editarEquipamento = function(index) {
    const equip = equipamentos[index];
    nomeInput.value = equip.nome;
    statusSelect.value = equip.status;
    causaInput.value = equip.causa || '';
    horaInicioInput.value = equip.horaInicio || '';
    horaFimInput.value = equip.horaFim || '';
    editandoIndex = index;
    nomeInput.focus();
  };

  window.excluirEquipamento = function(index) {
    equipamentos.splice(index, 1);
    renderTabela();
  };

  renderTabela();
</script>

</body>
</html>
